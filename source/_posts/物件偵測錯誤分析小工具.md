---
title: 物件偵測錯誤分析小工具
date: 2024-06-15 17:11:40
tags: 
  - YOLOv8
  - streamlit
categories: Project
---

這個小工具是根據 IoU 的範圍來對錯誤的預測結果做分類，
利用 streamlit 檢視分析後的圖形，
來擬定我該多收集怎樣的訓練資料來改進模型。

早在第一代 YOLO 的論文裡便有這種將錯誤做分類的方法，
用來做不同模型的準確度的比較：
{% asset_img yolov1_error_analysis.jpg "Error Analysis: Fast R-CNN vs. YOLO" %}
<!-- more -->
然後在 2020 年這一篇論文 TIDE[(官方 github)](https://github.com/dbolya/tide) 製作出了專門的小工具，
只是它是給 COCO 資料格式用的，
所以我撰寫了這個支援 YOLO 格式的版本[(我的 github 專案)](https://github.com/annsonic/identify_box_error)。

## 各類錯誤的定義

按照 TIDE 所提出的：

{% asset_img definition.png "Definition of error types" %}

## 對策

以下是個人淺見，僅供參考

  * 分類錯誤：是否 class imbalance 太嚴重，又可能是長相跟別的物件太相似
  * 定位不準：增加圖片的多樣性，檢查訓練資料標籤的準確度
  * 將背景誤認為物件：增加只有背景的圖片，Ultralytics 建議佔資料集的  0-10%
  * 沒偵測到：可能訓練資料不夠多，Ultralytics 建議一個種類有 1500 張影像


# 操作

  * 統計的圓餅圖
  
    {% asset_img proportions.png "Error types proportions" %}

  * 統計的直方圖（錯誤數量分佈）
  
    {% asset_img histogram.png "Errors per image" %}
    
    可以點選下拉選單選取圖片的檔名，會跳出視窗呈現圖中發生的錯誤位置
    
    {% asset_img annotations.png "Error type annotations" %}
    
  * 統計的直方圖（錯誤造成的 mAP 扣分）
    
    {% asset_img delta_map.png "Delta mAP" %}
